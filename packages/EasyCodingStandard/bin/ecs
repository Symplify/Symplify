#!/usr/bin/env php
<?php declare(strict_types=1);

use Composer\XdebugHandler\XdebugHandler;
use Symfony\Component\DependencyInjection\Container;
use Symplify\EasyCodingStandard\Console\EasyCodingStandardConsoleApplication;

$possibleAutoloadPaths = [
	__DIR__ . '/autoload.php',
	__DIR__ . '/../symplify/easy-coding-standard/bin/autoload.php',
];

foreach ($possibleAutoloadPaths as $autoloadPath) {
	if (file_exists($autoloadPath)) {
		require_once $autoloadPath;
		break;
	}
}

// performance boost
gc_disable();

$xdebug = new XdebugHandler('ecs', '--ansi');
$xdebug->check();
unset($xdebug);

$possibleContainerPaths = [
	__DIR__ . '/container.php',
	__DIR__ . '/../symplify/easy-coding-standard/bin/container.php',
];

foreach ($possibleContainerPaths as $containerPath) {
	if (file_exists($containerPath)) {
		/** @var Container $container */
		$container = require $containerPath;
		break;
	}
}

$application = $container->get(EasyCodingStandardConsoleApplication::class);
exit($application->run());
